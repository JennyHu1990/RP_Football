<html>
<head>
  <meta charset="utf-8">
  <title>Research Project</title>
    <link rel="stylesheet" href="./css/football.css" type="text/css" /></head>
    <link rel="stylesheet" href="./css/colorbrewer.css" type="text/css" /></head>
    <script src="./js/d3.v3.min.js"></script>
    <script src="./js/topojson.v1.min.js"></script>
    <script src="./js/d3.tip.v0.6.3.js"></script>
    <script src="./js/colorbrewer.js"></script>
    <script src="./js/echarts.min.js"></script>
    <script src="js/echarts.js"></script>
    <script src="./js/world.js"></script>
    <script src="./js/echarts-gl.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery-1.11.0.min.js"></script>
    <script src="./js/jquery-latest.min.js"></script>

</head>
<body>
<h1>Overview</h1>
<div class="visualization_Container" id="overview"></div>
<div class="visualization_Container" id="overCompetition"></div>
<h1>Player</h1>
<div style="overflow: hidden">
  <div class="visualization_Container" id="worldmaptime"></div>
    <p class="small-text" id="timer" style="font-size: 40px; line-height: 1.4;margin-left: 30px;">1992</p>
  <div class="buttonFormat" style="float: left; margin-left: 30px;">
    <input type="button" style="background-color : #311B92; color : white" id="worldMapRun" value="Run" class="btn">
    <input type="button" style="background-color : #311B92; color : white" id="worldMapReset" value="Reset" class="btn">
  </div>
</div>
<h1>Culture</h1>
<p id="culture">Image of immigrant</p>
<h1>Economy</h1>
<h1>Conclusion</h1>
<script type="text/javascript">
//animation
d3.json("json/world-110m2.json", function(error, map) {


    var width = 900,
        height = 600;

    // var sliceCounter = [1992,328, 1993,331, 1994,357, 1995,400 ,1996,536, 1997,684, 1998,791, 1999,838, 2000,885,
    //     2001,976, 2002,936, 2003,960, 2004,984, 2005,1004, 2006,1043, 2007,1121, 2008,1121,
    //     2009,1146, 2010,1180, 2011,1216, 2012,1284, 2013,1336, 2014,1338, 2015,1389, 2016,1442,
    //     2017,1454
    // ]

    var sliceCounter=[1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,
                      2011,2012,2013,2014,2015,2016,2017];

    var Counter = 1;


    var tip = d3.tip()
        .attr('class', 'd3-tip')
        .offset([-10, 0])
        .html(function(d) {
            return "<div style='color:white; background: cyan; opacity: 0.9; padding: 10px;'>" + "Birth Country: " + d.Country + "<br>Number: " + d.Number +"</div>";
        })

    // load and display the cities
    d3.csv("./data/animation.csv", function(error, data) {


        var projection = d3.geo.mercator()
            .scale(165)
            .translate([width / 2, height / 2])
            .rotate([0, 0])
            .center([0, 25])


        var svg = d3.select("body").select("#worldmaptime").append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        g.append("path")
            .datum(topojson.feature(map, map.objects.countries))
            .attr("d", d3.geo.path().projection(projection));

        var reset = "false"

        function europeTime(k)
        {

            var svg = d3.select("body").select("#worldmaptime").select("svg")
                .attr("width", width)
                .attr("height", height);


            var g = svg.append("g");


            var datanew = data.slice(sliceCounter[k])

            d3.select("body").select("#timer")
                .data(datanew)
                .text(function(d)
                {
                    var str = sliceCounter[k];
                    return str
                })

            g.selectAll("circle")
                .data(datanew)
                .enter()
                .append("circle")
                .attr("cx", function(d)
                {
                    return projection([d.longitude, d.latitude])[0]
                })
                .attr("cy", function(d)
                {
                    return projection([d.longitude, d.latitude])[1]
                })
                .attr("r", 8)
                .attr("fill", "#4CAF50")
                .attr("opacity", 0.04)

            if (sliceCounter[k] < 2017)
            {
                setTimeout(
                    function()
                    {
                        if (reset == "false")
                        {
                            k = k + 1;
                            europeTime(k)
                        }
                        else
                        {
                            Counter = 0;
                        }
                    }, 300)

            }

        }

        d3.select('#worldMapRun').on('click', function() {
            reset = "false";
            europeTime(1)
        });

        d3.select('#worldMapReset').on('click', function() {
            reset = "true";
            d3.select("body").select("#worldmaptime").selectAll("circle").remove();
            Counter = 0;
            d3.select("body").select("#timer")
                .style('font-size', function(d) {
                    return "40px"
                })
                .text("1992")
        });

    });

})

    //overview from different competition
    d3.json("json/world-110m2.json", function(error, map) {


        var width = 1000,
            height = 600;

        var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) {
                return "<div style='color:white; background: cyan; opacity: 0.9; padding: 10px;'>" + "Birth Country: " + d.Country + "<br>Number: " + d.Number +"</div>";
            })

        var projection = d3.geo.mercator()
            .scale(172)
            .translate([width / 2, height / 2])
            .rotate([0, 0])
            .center([0, 25])

        var svg = d3.select("body").select("#overCompetition").append("svg")
            .attr("width", width)
            .attr("height", height);

        var g = svg.append("g");

        g.append("path")
            .datum(topojson.feature(map, map.objects.countries))
            .attr("d", d3.geo.path().projection(projection));

        svg.call(tip);

        // load and display the cities
        d3.csv("./data/overviewDifferentCountries.csv", function(error, csvdata) {

            function europe(bubbleSize, competition1, competition2, competition3, competition4,competition5) {
                g.selectAll("circle")
                    .data(csvdata)
                    .enter()
                    .append("circle")
                    .attr("cx", function(d) {
                        return projection([d.longitude, d.latitude])[0];
                    })
                    .attr("cy", function(d) {
                        return projection([d.longitude, d.latitude])[1];
                    })
                    .attr("fill", function(d) {

                        if (d.Competition == competition1) {
                            return "#e74c3c"
                        } else if (d.Competition == competition2) {
                            return "#2ecc71"
                        } else if (d.Competition == competition3) {
                            return "#f1c40f"
                        } else if (d.Competition == competition4) {
                            return "#3498db"
                        } else if (d.Competition == competition5) {
                            return "#26C6DA"
                        }

                    })
                    .on("mouseover", tip.show)
                    .on("mouseout", tip.hide)
                    .attr("opacity", 0.7)
                    .attr("r", function(d) {
                        return (d.Count * 0.02)
                    })
            }


            europe("Count", "Bundesliga", "La Liga", "Ligue 1", "Serie A", "Premier League");



        });


    })


    //overview
    d3.json("./json/world-110m2.json", function(error, map) {

        var width = 1000,
            height = 600;

        var tip = d3.tip()
            .attr('class', 'd3-tip')
            .offset([-10, 0])
            .html(function(d) {
                return "<div style='color:white; background: cyan; opacity: 0.9; padding: 10px;'>" + "Birth Country: " + d.Country + "<br>Number: " + d.Number +"</div>";
            })

        var projection = d3.geo.mercator()
            .scale(172)
            .translate([width / 2, height / 2])
            .rotate([0, 0])
            .center([0, 25])

        var svg = d3.select("body").select("#overview").append("svg")
            .attr("width", width)
            .attr("height", height);


        var g = svg.append("g");


        g.append("path")
            .datum(topojson.feature(map, map.objects.countries))
            .attr("d", d3.geo.path().projection(projection));

        svg.call(tip);

        // load data
        d3.csv("./data/overview.csv", function(error, data) {
            g.selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("cx", function(d) {
                    return projection([d.longitude, d.latitude])[0];
                })
                .attr("cy", function(d) {
                    return projection([d.longitude, d.latitude])[1];
                })
                .attr("r", function(d) {
                    return (d.Number * 0.012)
                })
                .attr("fill", function(d) {
                    return "#36D7B7"
                })
                .attr("opacity", 0.90)
                .on("mouseover", tip.show)
                .on("mouseout", tip.hide);
        });

        var zoom = d3.behavior.zoom()
            .on("zoom", function() {
                g.attr("transform", "translate(" +
                    d3.event.translate.join(",") + ")scale(" + d3.event.scale + ")");
                g.selectAll("circle")
                    .attr("d", path.projection(projection));
                g.selectAll("path")
                    .attr("d", path.projection(projection));

            });


    })
</script>
<div class="d3-tip" style="position: absolute; opacity: 0;"></div>
<div class="d3-tip" style="position: absolute; opacity: 0;"></div>
</body>
</html>
